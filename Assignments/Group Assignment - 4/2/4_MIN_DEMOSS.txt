SELECT WORD, SUMOFSCORE/NODOC AS AVGSCORE FROM
  (SELECT SUM(SCORE) AS SUMOFSCORE, WORD, COUNT(SCORE) AS NODOC FROM
      (
        SELECT WORD, TDOC_ID AS DOC_ID, FREQ/DocSize AS SCORE FROM(
            (SELECT DOC_ID AS TDOC_ID, sum(FREQ) AS DocSize FROM INVINDEX GROUP BY TDOC_ID) 
                INNER JOIN
            (SELECT DOC_ID AS SDOC_ID, WORD, FREQ FROM INVINDEX)
                ON TDOC_ID=SDOC_ID
            )
    ) AS A
  GROUP BY WORD) AS F ORDER BY AVGSCORE DESC;
